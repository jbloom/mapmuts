<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mapmuts_preferencemeans.py &mdash; mapmuts 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="mapmuts 1.1 documentation" href="index.html" />
    <link rel="up" title="Scripts" href="scripts.html" />
    <link rel="next" title="mapmuts_siteprofileplots.py" href="mapmuts_siteprofileplots.html" />
    <link rel="prev" title="mapmuts_preferencescorrelate.py" href="mapmuts_preferencescorrelate.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mapmuts_siteprofileplots.html" title="mapmuts_siteprofileplots.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mapmuts_preferencescorrelate.html" title="mapmuts_preferencescorrelate.py"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">mapmuts 1.1 documentation</a> &raquo;</li>
          <li><a href="scripts.html" accesskey="U">Scripts</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mapmuts-preferencemeans-py">
<span id="id1"></span><h1>mapmuts_preferencemeans.py<a class="headerlink" href="#mapmuts-preferencemeans-py" title="Permalink to this headline">¶</a></h1>
<p>This is a simple script that computes the mean of the amino acid preferences or differential preferences inferred by several runs of <a class="reference internal" href="mapmuts_inferpreferences.html#mapmuts-inferpreferences-py"><em>mapmuts_inferpreferences.py</em></a> or <a class="reference internal" href="mapmuts_inferdifferentialpreferences.html#mapmuts-inferdifferentialpreferences-py"><em>mapmuts_inferdifferentialpreferences.py</em></a>.</p>
<div class="section" id="preferences">
<h2>Preferences<a class="headerlink" href="#preferences" title="Permalink to this headline">¶</a></h2>
<p>If using amino-acid preferences (<em>preferencefiles</em> argument in <a class="reference internal" href="#input-file">Input file</a>), then we are working with the following data.</p>
<p>For each residue <em>r</em> in a protein, the script <a class="reference internal" href="mapmuts_inferpreferences.html#mapmuts-inferpreferences-py"><em>mapmuts_inferpreferences.py</em></a> computes the preference of that site for each amino acid <em>a</em>, which is denoted as <span class="math">\(\pi_{r,a}\)</span>. These preferences sum to one, so <span class="math">\(1 = \sum_a \pi_{r,a}\)</span>. It is possible that you have run several replicates of <a class="reference internal" href="mapmuts_inferpreferences.html#mapmuts-inferpreferences-py"><em>mapmuts_inferpreferences.py</em></a>, such as for several different replicates of an experiment. You then might want to compute the average preference for each amino acid taken over the replicates. This script does that, and writes the output to a file.</p>
<p>Specifically, let <span class="math">\(\pi_{r,a}^i\)</span> denote the preference for amino acid <em>a</em> at site <em>r</em> computed for replicate <em>i</em>, where <span class="math">\(i = 1, \ldots N\)</span> where <em>N</em> is the number of replicates. Then the mean preference of site <em>r</em> for amino acid <em>a</em> is <span class="math">\(\langle \pi_{r,a} \rangle = \frac{1}{N} \sum_i \pi_{r,a}^i\)</span>. Note that because the preferences sum to one for each individual library, it will also be the case that <span class="math">\(1 = \sum_a \langle \pi_{r,a} \rangle\)</span>.</p>
</div>
<div class="section" id="differential-preferences">
<h2>Differential preferences<a class="headerlink" href="#differential-preferences" title="Permalink to this headline">¶</a></h2>
<p>If using differential amino-acid preferences (<em>differentialpreferencefiles</em> argument in <a class="reference internal" href="#input-file">Input file</a>), then we are working with the following data.</p>
<p>For each residue <span class="math">\(r\)</span> in a protein, the script <a class="reference internal" href="mapmuts_inferdifferentialpreferences.html#mapmuts-inferdifferentialpreferences-py"><em>mapmuts_inferdifferentialpreferences.py</em></a> computes the differential preference <span class="math">\(\Delta\pi_{r,a}\)</span> of that site for amino acid <span class="math">\(a\)</span>. These differential preferences sum to zero, so <span class="math">\(0 = \sum_a \Delta\pi_{r,a}\)</span>. This script is designed for the case when you have performed several runs of <a class="reference internal" href="mapmuts_inferdifferentialpreferences.html#mapmuts-inferdifferentialpreferences-py"><em>mapmuts_inferdifferentialpreferences.py</em></a> on different samples, and want to compute the average.</p>
<p>Specifically, then <span class="math">\(\Delta\pi_{r,a}^i\)</span> denote the differential preferences for replicate <span class="math">\(i\)</span>, where <span class="math">\(i = 1, \ldots N\)</span> where <span class="math">\(N\)</span> is the number of replicates. Then the mean differential preference of site <span class="math">\(r\)</span> for amino acid <span class="math">\(a\)</span> is <span class="math">\(\langle \Delta\pi_{r,a} \rangle = \frac{1}{N} \sum_i \Delta\pi_{r,a}^i\)</span>. Note that because the differential preferences sum to zero for each individual replicate, it will also be the case that the average differential preferences sum to zero.</p>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>This script has no dependencies outside of <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> and the standard <a class="reference external" href="http://www.python.org/">Python</a> library.</p>
</div>
<div class="section" id="running-the-script">
<h3>Running the script<a class="headerlink" href="#running-the-script" title="Permalink to this headline">¶</a></h3>
<p>To run this script from the prompt, first create a text infile of the
format described below. Then simply run the script with the single text file as the argument, as in:</p>
<div class="highlight-python"><div class="highlight"><pre>mapmuts_preferencemeans.py infile.txt
</pre></div>
</div>
</div>
<div class="section" id="input-file">
<h3>Input file<a class="headerlink" href="#input-file" title="Permalink to this headline">¶</a></h3>
<p>The input file is a text file with a series of <em>key</em> / <em>value</em> pairs. The required keys are indicated below. The values should not include spaces.</p>
<p>Lines beginning with # and empty lines are ignored.</p>
<p>Keys for the input file:</p>
<ul>
<li><p class="first"><em>preferencefiles</em> : You should specify <strong>either</strong> this argument or <em>differentialpreferencefiles</em>, but not both. If using <em>preferencefiles</em>, this argument should be followed by a list of the <tt class="docutils literal"><span class="pre">*_equilibriumpreferences.txt</span></tt> files created by <a class="reference internal" href="mapmuts_inferpreferences.html#mapmuts-inferpreferences-py"><em>mapmuts_inferpreferences.py</em></a>. You must specify at least two such files (if there were just one, you wouldn&#8217;t need to run this script). So this key should be followed by a list of two or more <tt class="docutils literal"><span class="pre">*_equilibriumpreferences.txt</span></tt> files.</p>
<p>Note that it is optional whether a preference is specified for stop codons (indicated by a * character) in the last column. But all files specified here must be consistent &#8211; they either all must specify a preference for a stop codon, or all must not specify a preference for a stop codon.</p>
</li>
<li><p class="first"><em>differentialpreferencefiles</em> : You should specify <strong>either</strong> this argument or <em>preferencefiles</em>, but not both. If using <em>differentialpreferencefiles</em>, this argument should be followed by a list of the <tt class="docutils literal"><span class="pre">differentialpreferences_selection_*.txt</span></tt> files created by <a class="reference internal" href="mapmuts_inferdifferentialpreferences.html#mapmuts-inferdifferentialpreferences-py"><em>mapmuts_inferdifferentialpreferences.py</em></a>. You must specify at least two such files (if there were just one, you wouldn&#8217;t need to run this script).</p>
<p>Note that it is optional whether a preference is specified for stop codons (indicated by a * character) in the last column. But all files specified here must be consistent &#8211; they either all must specify a preference for a stop codon, or all must not specify a preference for a stop codon.</p>
</li>
<li><p class="first"><em>outfile</em> is the name of the created output file. This output file is in the same format as the input files in <em>preferencefiles</em>, but now contains the average preference.</p>
</li>
<li><p class="first"><em>includestop</em> specifies whether we include stop codons (denoted by a * character) as possible amino acids in the generated <em>outfile</em>. If the input <em>preferencefiles</em> / <em>differentialpreferencefiles</em> do not specify stop codons as an amino acid, then no stop codons are ever included in <em>outfile</em> and this option is meaningless. But the input files do specify stop codon preferences, the <em>includestop</em> is meaningful. In this case:</p>
<blockquote>
<div><ul class="simple">
<li>If <em>includestop</em> is <em>True</em> then <em>outfile</em> also contains these stop codons as possible amino acids.</li>
<li>If <em>includestop</em> is <em>False</em>, then stop codons are not included as possible amino acids. In this case, the <span class="math">\(\pi_{r,a}\)</span> values for the 20 non-stop amino acids are normalized so that they sum to one.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="example-input-file">
<h3>Example input file<a class="headerlink" href="#example-input-file" title="Permalink to this headline">¶</a></h3>
<p>Here is an example input file:</p>
<div class="highlight-python"><div class="highlight"><pre># Input file for mapmuts_preferencemeans.py
preferencefiles WT-1_equilibriumpreferences.txt WT-2_equilibriumpreferences.txt N334H-1_equilibriumpreferences.txt N334H-2_equilibriumpreferences.txt
outfile mean_equilibriumpreferences.txt
includestop False
</pre></div>
</div>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>The script writes some brief output to standard output.</p>
<p>The file specified by <em>outfile</em> is created (or overwritten if it already exists). This file has the exact same format as the input files listed in <em>preferencefiles</em> or <em>differentialpreferencfiles</em>, except the indicated preferences / differential preferences are now average values. The entropies or RMS differential preferences (third columns of these files) are recomputed.</p>
<p>The entries for the wildtype amino acid (second column, <em>WT_AA</em>) show either the single wildtype amino acid (if identical in all files) or a comma delimited list of all wildtype amino acids in the different files (such as <em>N,N,H,H</em> if the <em>preferencefiles</em> have wildtype amino acids <em>N</em>, <em>N</em>, <em>H</em>, and <em>H</em> for four such files).</p>
<p>The <em>outfile</em> created by this script is valid input to <a class="reference internal" href="mapmuts_siteprofileplots.html#mapmuts-siteprofileplots-py"><em>mapmuts_siteprofileplots.py</em></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">mapmuts_preferencemeans.py</a><ul>
<li><a class="reference internal" href="#preferences">Preferences</a></li>
<li><a class="reference internal" href="#differential-preferences">Differential preferences</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#running-the-script">Running the script</a></li>
<li><a class="reference internal" href="#input-file">Input file</a></li>
<li><a class="reference internal" href="#example-input-file">Example input file</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mapmuts_preferencescorrelate.html"
                        title="previous chapter">mapmuts_preferencescorrelate.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mapmuts_siteprofileplots.html"
                        title="next chapter">mapmuts_siteprofileplots.py</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/mapmuts_preferencemeans.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mapmuts_siteprofileplots.html" title="mapmuts_siteprofileplots.py"
             >next</a> |</li>
        <li class="right" >
          <a href="mapmuts_preferencescorrelate.html" title="mapmuts_preferencescorrelate.py"
             >previous</a> |</li>
        <li><a href="index.html">mapmuts 1.1 documentation</a> &raquo;</li>
          <li><a href="scripts.html" >Scripts</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3a0.
    </div>
  </body>
</html>