<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2013 analysis of Influenza NP (Aichi/1968) &mdash; mapmuts 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="mapmuts 1.0 documentation" href="index.html" />
    <link rel="up" title="Examples" href="examples.html" />
    <link rel="next" title="Python modules" href="pythonapi.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pythonapi.html" title="Python modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">mapmuts 1.0 documentation</a> &raquo;</li>
          <li><a href="examples.html" accesskey="U">Examples</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analysis-of-influenza-np-aichi-1968">
<h1><a class="toc-backref" href="#id1">2013 analysis of Influenza NP (Aichi/1968)</a><a class="headerlink" href="#analysis-of-influenza-np-aichi-1968" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#analysis-of-influenza-np-aichi-1968" id="id1">2013 analysis of Influenza NP (Aichi/1968)</a><ul>
<li><a class="reference internal" href="#overview" id="id2">Overview</a></li>
<li><a class="reference internal" href="#outline-of-experiment" id="id3">Outline of experiment</a></li>
<li><a class="reference internal" href="#software-used" id="id4">Software used</a></li>
<li><a class="reference internal" href="#input-files" id="id5">Input files</a></li>
<li><a class="reference internal" href="#analysis-steps-and-results" id="id6">Analysis steps and results</a><ul>
<li><a class="reference internal" href="#making-alignments" id="id7">Making alignments</a></li>
<li><a class="reference internal" href="#parsing-mutations" id="id8">Parsing mutations</a></li>
<li><a class="reference internal" href="#checking-mutation-sampling-completeness" id="id9">Checking mutation sampling completeness</a></li>
<li><a class="reference internal" href="#inference-of-amino-acid-preferences" id="id10">Inference of amino-acid preferences</a></li>
<li><a class="reference internal" href="#summary-of-amino-acid-preferences" id="id11">Summary of amino-acid preferences</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id2">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This is a description of the analysis of mutagenesis and deep-sequencing of the nucleoprotein (NP) from the human H3N2 influenza strain A/Aichi/2/1968. The ultimate goal is to infer the preference of each site for each possible amino acid.</p>
<p>This is the analysis described at <a class="reference external" href="http://biorxiv.org/content/early/2014/04/27/002899">Bloom 2014</a>.</p>
<p>The overall conceptual approach of the experiments is similar to the strategy originally described by <a class="reference external" href="http://www.nature.com/nmeth/journal/v7/n9/full/nmeth.1492.html">Fowler et al</a>.</p>
<p>The sequencing and analysis was performed by <a class="reference external" href="http://research.fhcrc.org/bloom/en.html">Jesse Bloom</a> using the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> package. The sequencing was performed in 2013, and the analysis extended from 2013 to 2014.</p>
<p>This analysis can be replicated if you install the appropriate software (see <a class="reference internal" href="#software-used">Software used</a>) by downloading the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> repository <a class="reference external" href="https://github.com/jbloom/mapmuts">on GitHub</a> and going to the directory <tt class="docutils literal"><span class="pre">./examples/2013Analysis_Influenza_NP_Aichi68/</span></tt> in the main <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> package directory. This will contain all of the necessary input files (see <a class="reference internal" href="#input-files">Input files</a>) with the exception of the very large Illumina FASTQ files, which are available at <a class="reference external" href="http://www.ncbi.nlm.nih.gov/sra/?term=SRP036064">SRA accession SRP036064</a>. Once all of this is set up, you can replicate the analysis with the simple command:</p>
<div class="highlight-python"><div class="highlight"><pre>python run_mapmuts.py
</pre></div>
</div>
<p>The complete analysis performed by this script generates a large amount of output &#8211; to much to easily store in the <tt class="docutils literal"><span class="pre">./examples/2013Analysis_Influenza_NP_Aichi68</span></tt> subdirectory of the main <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> repository <a class="reference external" href="https://github.com/jbloom/mapmuts">on GitHub</a>. Therefore, only the key output files described below are retained in the repository. However, the entire analysis with all output files can be re-generated on your computer using the <tt class="docutils literal"><span class="pre">run_mapmuts.py</span></tt> script as described below.</p>
</div>
<div class="section" id="outline-of-experiment">
<h2><a class="toc-backref" href="#id3">Outline of experiment</a><a class="headerlink" href="#outline-of-experiment" title="Permalink to this headline">¶</a></h2>
<p>The basic idea of the experiment is to create plasmid mutant libraries of influenza nucleoprotein, rescue pools of mutant viruses by reverse genetics, and then passage the viruses twice at moderately low multiplicity of infection (MOI) in tissue culture. The viral cDNA is deep sequencing at each step using overlapping paired-end 50-nt Illumina reads. Some controls are also included.</p>
<p>Overall, each <em>sample</em> contains seven <em>amplicons</em>, which are illustrated graphically below:</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_schematic.jpg"><img alt="schematic.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_schematic.jpg" style="width: 75%;" /></a>
<p class="caption">Schematic of the <em>amplicons</em> (in yellow) for each <em>sample</em>.</p>
</div>
</div></blockquote>
<p>The <em>amplicons</em> are as follows:</p>
<blockquote>
<div><ul class="simple">
<li><em>DNA</em> : Measures error-rate on sequencing unmutated plasmid DNA.</li>
<li><em>mutDNA</em> : Measures mutation rate in plasmid mutant library.</li>
<li><em>RNA</em> : Measures error-rate on sequencing reverse-transcribed RNA.</li>
<li><em>virus-p1</em> : Unmutated virus passaged once.</li>
<li><em>virus-p2</em> : Unmutated virus passaged twice.</li>
<li><em>mutvirus-p1</em> : Mutant virus passaged once.</li>
<li><em>mutvirus-p2</em>: Mutant virus passaged twice.</li>
</ul>
</div></blockquote>
<p>There are four independent <em>samples</em> that each contain these seven <em>amplicons</em>. Each of these samples is grown from an independently created plasmid mutant library. Each <em>sample</em> is sequencing on its own Illumina lane, with the seven <em>amplicons</em> multi-plexed on the lane. The samples are:</p>
<blockquote>
<div><ul class="simple">
<li><em>WT-1</em> : Mutant library built from wildtype Aichi/1968 NP.</li>
<li><em>WT-2</em> : Another mutant library built from wildtype Aichi/1968 NP.</li>
<li><em>N334H-1</em> : Mutant library built from the N334H mutant of the  Aichi/1968 NP. N334H is a stabilizing mutation to this NP as described by <a class="reference external" href="http://elife.elifesciences.org/content/2/e00631">Gong et al</a>.</li>
<li><em>N334H-2</em> : Another mutant library built from the N334H mutant of the Aichi/1968 NP.</li>
</ul>
</div></blockquote>
<p>Finally, two experimental <em>replicates</em> are performed for the set of four <em>samples</em>. Each of these <em>replicates</em> involves total replication of the viral growth and passaging and the sequencing. The two replicates are:</p>
<blockquote>
<div><ul class="simple">
<li><em>replicate_A</em></li>
<li><em>replicate_B</em></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="software-used">
<h2><a class="toc-backref" href="#id4">Software used</a><a class="headerlink" href="#software-used" title="Permalink to this headline">¶</a></h2>
<p>This analysis was performed using the following software
on the Fred Hutchinson computer cluster using the following Linux distribution:</p>
<div class="highlight-python"><div class="highlight"><pre>Linux version 3.5.0-43-generic (buildd@roseapple) (gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) ) #66~precise1-Ubuntu SMP Thu Oct 24 14:52:23 UTC 2013
</pre></div>
</div>
<p>In order to replicate the analysis, you will also need to use Linux or Mac OS X, and install the following software.</p>
<p>The specific software versions used for the analysis are specified. You can probably also use other software versions in many cases, but this has not been confirmed.</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> version 1.0</li>
<li><a class="reference external" href="https://www.python.org">Python</a> version 2.7.3</li>
<li><a class="reference external" href="http://www.numpy.org/">numpy</a> version 1.6.1</li>
<li><a class="reference external" href="http://matplotlib.org/">matplotlib</a> version 1.3.1</li>
<li><a class="reference external" href="http://pymc-devs.github.io/pymc/">pymc</a> version 2.3</li>
<li><a class="reference external" href="http://www.scipy.org/">scipy</a> version 0.9.0</li>
<li><a class="reference external" href="http://pybrary.net/pyPdf/">pyPdf</a> version 1.13</li>
<li><a class="reference external" href="http://www.tug.org/applications/pdftex/">pdflatex</a> version 3.1415926-1.40.10-2.2</li>
<li><a class="reference external" href="http://weblogo.threeplusone.com/">weblogo</a> version 3.3</li>
<li><a class="reference external" href="http://www.imagemagick.org/script/convert.php">ImageMagick convert</a> 6.6.9-7 2012-08-17</li>
<li><a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> (version 2.6.2) was used by the <tt class="docutils literal"><span class="pre">run_mapmuts.py</span></tt> script to submit the jobs on a computer cluster.</li>
</ul>
</div>
<div class="section" id="input-files">
<h2><a class="toc-backref" href="#id5">Input files</a><a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>Here is a listing of the input data / files that are necessary to repeat the analysis if all of the appropriate software is installed. These are the names assigned to the files within the <tt class="docutils literal"><span class="pre">./examples/2013Analysis_Influenza_NP_Aichi68</span></tt> subdirectory of the main <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> package.</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">run_mapmuts.py</span></tt> is a <a class="reference external" href="https://www.python.org">Python</a> script that will perform the entire analysis assuming that you have all of the specified software (see <a class="reference internal" href="#software-used">Software used</a>) and input files (see <a class="reference internal" href="#input-files">Input files</a>) installed. To run this script, simply type:</p>
<div class="highlight-python"><div class="highlight"><pre>python run_mapmuts.py
</pre></div>
</div>
<p>at the command line. Note that the script has an option to use <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> to submit the jobs in parallel on a computing cluster. This option was used during the analysis described here. If you don&#8217;t want to use <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a>, modify the <em>use_sbatch</em> option hard-coded within the <tt class="docutils literal"><span class="pre">run_mapmuts.py</span></tt> script.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">./FASTQ_files/</span></tt> is a subdirectory that contains the Illumina FASTQ files. Please note that this subdirectory is <strong>not</strong> distributed with the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> package <a class="reference external" href="https://github.com/jbloom/mapmuts">on GitHub</a> because of the very large size of these files. Instead, you can download the FASTQ files from <a class="reference external" href="http://www.ncbi.nlm.nih.gov/sra/?term=SRP036064">SRA accession SRP036064</a>.</p>
<p>The download from <a class="reference external" href="http://www.ncbi.nlm.nih.gov/sra/?term=SRP036064">SRA accession SRP036064</a> will give you the <tt class="docutils literal"><span class="pre">*.sra</span></tt> files. In order to process these with the <tt class="docutils literal"><span class="pre">run_mapmuts.py</span></tt> script provided here, you will need to convert the reads into <tt class="docutils literal"><span class="pre">*.fastq</span></tt> files and place in a directory called <tt class="docutils literal"><span class="pre">./FASTQ_files/</span></tt>. Within this directory, there should be a different subdirectory for each <em>replicate</em> (i.e. <tt class="docutils literal"><span class="pre">./FASTQ_files/replicate_A/</span></tt>). Each <em>sample</em> and <em>amplicon</em> should then have its own subdirectory with names such as <tt class="docutils literal"><span class="pre">./FASTQ_files/replicate_A/Sample_WT-1_DNA/</span></tt>. Within these subdirectories, there should be gzipped <tt class="docutils literal"><span class="pre">*.fastq</span></tt> files for the read 1 and read 2, specified by <em>R1</em> and <em>R2</em> somewhere in the file name. For example, for <em>replicate_A</em>, <em>WT-1</em>, <em>DNA</em> there should be files matching the following:</p>
<div class="highlight-python"><div class="highlight"><pre>./FASTQ_files/replicate_A/Sample_WT-1_DNA/*R1*.fastq.gz
./FASTQ_files/replicate_A/Sample_WT-1_DNA/*R2*.fastq.gz
</pre></div>
</div>
<p>The FASTQ files themselves were generated by processing and de-multiplexing the Illumina reads with the CASAVA pipeline (version 1.8.2).</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">R1_trim3.fasta</span></tt> and <tt class="docutils literal"><span class="pre">R2_trim3.fasta</span></tt> specify the adaptor sequences that are found at the 3&#8217; end after the insert of R1 or R2 reads, respectively. These files are needed to delineate the sequence that we expect to find at the 3&#8217; ends of any 50-nt reads of inserts that are less than 50 nt, since for such inserts the read will extend into the adaptor.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Aichi68-NP_amplicon.fasta</span></tt> and <tt class="docutils literal"><span class="pre">Aichi68-NP-N334H_amplicon.fasta</span></tt> are FASTA files that give the sequences of the full PCR amplicons which are fragmented for sequencing. These include the gene sequence of interest plus the extra sequence added by PCR primers during amplification of the gene. There are two files, one giving the sequence for the wildtype and one for the N334H mutant of the NP from A/Aichi/2/1968 (H3N2) influenza.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Sanger_codontypes.txt</span></tt> and <tt class="docutils literal"><span class="pre">Sanger_codonnmuts.txt</span></tt> are text files that give the estimated frequencies of different types of mutations for the <em>mutDNA</em> libraries based on Sanger sequencing of some clones. <tt class="docutils literal"><span class="pre">Sanger_codontypes.txt</span></tt> lists the estimated per-codon frequencies of synonymous, nonsynonymous, and stop codon mutations. <tt class="docutils literal"><span class="pre">Sanger_codonnmuts.txt</span></tt> lists the estimated per-codon frequencies of one-, two-, and three-nucleotide codon mutations.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">./DSSP_analysis/</span></tt> is a subdirectory that contains the results of analyzing the solvent accessibilities and secondary structures of NP from the crystal structure. Briefly, the NP crystal structure in <a class="reference external" href="http://www.rcsb.org/pdb/explore.do?structureId=2iqh">PDB 2IQH</a> was downloaded, and the <tt class="docutils literal"><span class="pre">2IQH.pdb</span></tt> file was manually edited to extract only monomer C into <tt class="docutils literal"><span class="pre">2IQH_monomerC.pdb</span></tt>. This monomer was then analyzed with the <a class="reference external" href="http://www.cmbi.ru.nl/hsspsoap/">DSSP webserver</a> to create the results stored in <tt class="docutils literal"><span class="pre">2IQH_monomerC.dssp</span></tt>.</p>
</li>
</ul>
</div>
<div class="section" id="analysis-steps-and-results">
<h2><a class="toc-backref" href="#id6">Analysis steps and results</a><a class="headerlink" href="#analysis-steps-and-results" title="Permalink to this headline">¶</a></h2>
<p>You can run the entire analysis with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>python run_analysis.py
</pre></div>
</div>
<p>The individual steps and results are as follows:</p>
<div class="section" id="making-alignments">
<h3><a class="toc-backref" href="#id7">Making alignments</a><a class="headerlink" href="#making-alignments" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <tt class="docutils literal"><span class="pre">mapmuts_makealignments.py</span></tt> is used to align the overlapping paired-end reads to the template gene.</p>
<p>Each analysis is run in a subdirectory that conforms to <em>replicate/sample/amplicon/</em>, such as <tt class="docutils literal"><span class="pre">replicate_A/WT-1/DNA/</span></tt>.</p>
<p>The master <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> script creates an input file, <tt class="docutils literal"><span class="pre">makealignments_infile.txt</span></tt>, that specifies the specific criteria that are used to make the alignments. These criteria determine what read pairs are considered to successfully overlap and align, and which are discarded. The lines specifying the alignment criteria in these <tt class="docutils literal"><span class="pre">makealignments_infile.txt</span></tt> files are as follows (the meanings are detailed in the <a class="reference external" href="http://jbloom.github.io/mapmuts/">mapmuts documentation</a> for <tt class="docutils literal"><span class="pre">mapmuts_makealignments.py</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre>applyfilter True
minq 25
maxn 2
minoverlap 30
maxa1m 1
maxa2m 1
maxrm 1
maxgenem 6
</pre></div>
</div>
<p>Within each subdirectory are the files created by <tt class="docutils literal"><span class="pre">mapmuts_makealignments.py</span></tt>. Here are the ones that will be of greatest interest. All of these files-of-greatest-interest are part of the repository <a class="reference external" href="https://github.com/jbloom/mapmuts">on GitHub</a> except as specifically noted below:</p>
<blockquote>
<div><ul>
<li><p class="first">The <tt class="docutils literal"><span class="pre">*_alignments.txt.gz</span></tt> file gives the alignments of the reads to the template gene. This file is <strong>not</strong> included in the repository <a class="reference external" href="https://github.com/jbloom/mapmuts">on GitHub</a> due to its large size.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">*_unaligned.fasta.gz</span></tt> file contains reads that could not be aligned with the specified criteria. This file is <strong>not</strong> included in the repository <a class="reference external" href="https://github.com/jbloom/mapmuts">on GitHub</a> due to its large size.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">*_makealignments_log.txt</span></tt> file records the progress of the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <tt class="docutils literal"><span class="pre">mapmuts_makealignments.py</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">*_alignmentstatistics.pdf</span></tt> file shows how many reads could be overlapped and aligned to the template gene. In general, a high fraction of reads could be overlappend and aligned to the template. An example is below:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_DNA_replicate_A_WT-1_DNA_alignmentstatistics.jpg"><img alt="replicate_A/WT-1/DNA/replicate_A_WT-1_DNA_alignmentstatistics.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_DNA_replicate_A_WT-1_DNA_alignmentstatistics.jpg" style="width: 45%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">*_alignmentstatistics.pdf</span></tt> plot for <em>replicate_A</em>, <em>WT-1</em>, <em>DNA</em>.</p>
</div>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">*_insertlengths.pdf</span></tt> file shows the lengths of the inserts that could be overlapped and aligned to the template gene. The target insert length is 50 nucleotides &#8211; in most cases the distribution was reasonably distributed around that target. An example is below:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_DNA_replicate_A_WT-1_DNA_insertlengths.jpg"><img alt="replicate_A/WT-1/DNA/replicate_A_WT-1_DNA_insertlengths.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_DNA_replicate_A_WT-1_DNA_insertlengths.jpg" style="width: 45%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">*_insertlengths.pdf</span></tt> plot for <em>replicate_A</em>, <em>WT-1</em>, <em>DNA</em>.</p>
</div>
</li>
</ul>
</div></blockquote>
<p>The <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <tt class="docutils literal"><span class="pre">mapmuts_alignmentsummaryplot.py</span></tt> is then used to summarize how many reads could be overlapped and aligned for all <em>amplicons</em> and <em>samples</em> for each <em>replicate</em>. The plots have the name <tt class="docutils literal"><span class="pre">alignmentsummaryplot.pdf</span></tt> and are in the subdirectory for each <em>replicate</em> (so for example <tt class="docutils literal"><span class="pre">replicate_A/alignmentsummaryplot.pdf</span></tt>).</p>
<p>Below are the summary plots. This plot shows a large number of overlapped and aligned reads for all <em>amplicons</em>. The reason that the bars aren&#8217;t all exactly equal height for all <em>amplicons</em> within a <em>sample</em> is that the barcoded DNA was not pooled exactly evenly owing to imperfect quantification.</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_alignmentsummaryplot.jpg"><img alt="replicate_A/alignmentsummaryplot.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_alignmentsummaryplot.jpg" style="width: 65%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">alignmentsummaryplot.pdf</span></tt> plot for <em>replicate_A</em>.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_B_alignmentsummaryplot.jpg"><img alt="replicate_B/alignmentsummaryplot.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_B_alignmentsummaryplot.jpg" style="width: 65%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">alignmentsummaryplot.pdf</span></tt> plot for <em>replicate_B</em>.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="parsing-mutations">
<h3><a class="toc-backref" href="#id8">Parsing mutations</a><a class="headerlink" href="#parsing-mutations" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <tt class="docutils literal"><span class="pre">mapmuts_parsecounts.py</span></tt> is used to parse the counts of mutations out of the alignments created in the previous step.</p>
<p>Each analysis is run in a subdirectory that conforms to <em>replicate/sample/amplicon/</em>, such as <tt class="docutils literal"><span class="pre">replicate_A/WT-1/DNA/</span></tt> &#8211; these subdirectories already contain the alignment results.</p>
<p>The master <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> script creates an input file, <tt class="docutils literal"><span class="pre">parsecounts_infile.txt</span></tt> that serves as input to <tt class="docutils literal"><span class="pre">mapmuts_parsecounts.py</span></tt>.
Within each subdirectory are the files created by <tt class="docutils literal"><span class="pre">mapmuts_parsecounts.py</span></tt>. Here are the ones that will be of greatest interest:</p>
<blockquote>
<div><ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">*_codoncounts.txt</span></tt> gives the counts for all of the different codons identified at each site, in the format described in the <a class="reference external" href="http://jbloom.github.io/mapmuts/">mapmuts documentation</a>.</li>
<li>The <tt class="docutils literal"><span class="pre">*_parsecounts_log.txt</span></tt> file logs the progress of <tt class="docutils literal"><span class="pre">mapmuts_parsecounts.py</span></tt>.</li>
<li>The <tt class="docutils literal"><span class="pre">*_codondepth.pdf</span></tt> file plots the read depth for each codon. Below are example plots for a <em>DNA</em> and <em>mutDNA</em> amplicon. From these examples, you can see that the read depth was fairly good across the gene with one notable dip at a consistent location (presumably due to poor fragmentation of the amplicon at this location).</li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_DNA_replicate_A_WT-1_DNA_codondepth.jpg"><img alt="replicate_A/WT-1/DNA/replicate_A_WT-1_DNA_codondepth.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_DNA_replicate_A_WT-1_DNA_codondepth.jpg" style="width: 60%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">replicate_A/WT-1/DNA/replicate_A_WT-1_DNA_codondepth.pdf</span></tt> plot.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_mutDNA_replicate_A_WT-1_mutDNA_codondepth.jpg"><img alt="replicate_A/WT-1/mutDNA/replicate_A_WT-1_mutDNA_codondepth.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_WT-1_mutDNA_replicate_A_WT-1_mutDNA_codondepth.jpg" style="width: 60%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">replicate_A/WT-1/mutDNA/replicate_A_WT-1_mutDNA_codondepth.pdf</span></tt> plot.</p>
</div>
</div></blockquote>
<p>The <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <tt class="docutils literal"><span class="pre">mapmuts_parsesummaryplots.py</span></tt> is then used to summarize the mutations for all <em>amplicons</em> and <em>samples</em> for each <em>replicate</em>. The output here is in the subdirectory for each <em>replicate</em>, and consists of the following three files:</p>
<blockquote>
<div><ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">parsesummary_codontypes.txt</span></tt> gives the overall fraction of mutations to each type of mutation (synonymous, nonsynonymous, stop codon) for each <em>amplicon</em> and <em>sample</em>.</li>
<li>The <tt class="docutils literal"><span class="pre">parsesummary_codonnmuts.txt</span></tt> gives the overall fraction of mutations with one-, two-, and three-nucleotide changes for each <em>amplicon</em> and <em>sample</em>.</li>
<li>The <tt class="docutils literal"><span class="pre">parsesummary_codon_types_and_nmuts.pdf</span></tt> plot gives a graphical summary of the frequencies of different types of mutations.</li>
</ul>
</div></blockquote>
<p>These last plots are the key summary figures. They are shown below:</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_parsesummary_codon_types_and_nmuts.jpg"><img alt="replicate_A/parsesummary_codon_types_and_nmuts.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_parsesummary_codon_types_and_nmuts.jpg" style="width: 65%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">replicate_A/parsesummary_codon_types_and_nmuts.pdf</span></tt> plot for <em>replicate_A</em>.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_B_parsesummary_codon_types_and_nmuts.jpg"><img alt="replicate_B/parsesummary_codon_types_and_nmuts.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_B_parsesummary_codon_types_and_nmuts.jpg" style="width: 65%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">replicate_B/parsesummary_codon_types_and_nmuts.pdf</span></tt> plot for <em>replicate_B</em>.</p>
</div>
</div></blockquote>
<p>Key points from these plots:</p>
<blockquote>
<div><ul class="simple">
<li>The sequencing error rate (<em>DNA</em>) is low.</li>
<li>The reverse-transcription error rate (<em>RNA</em>) is not much worse.</li>
<li>Very few de-novo mutations arise during virus growth (<em>mutvirus-p1</em> and <em>mutvirus-p2</em>).</li>
<li>The plasmid mutant library has a good frequency of mutations (<em>mutDNA</em>).</li>
<li>Viral growth selects against many of the stop codons and nonsynonymous mutations (<em>mutvirus-p1</em> versus <em>mutDNA</em>).</li>
<li>There is very little change in the frequency of mutations between one and two virus passages (<em>mutvirus-p1</em> versus <em>mutvirus-p2</em>).</li>
<li>The error frequency in the <em>mutDNA</em> is similar to that obtained by some <em>Sanger</em> sequencing when the additional sequencing error rate manifested in the <em>DNA</em> sample is accounted for.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="checking-mutation-sampling-completeness">
<h3><a class="toc-backref" href="#id9">Checking mutation sampling completeness</a><a class="headerlink" href="#checking-mutation-sampling-completeness" title="Permalink to this headline">¶</a></h3>
<p>An analysis was performed to see how completely the possible mutations were sampled for each <em>replicate</em> (looking at the net sampling over the pooled <em>samples</em> for each replicate). To do this, the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <tt class="docutils literal"><span class="pre">mapmuts_countparsedmuts.py</span></tt> was used.</p>
<p>Each analysis was done in the subdirectory for that <em>replicate</em> (i.e. <tt class="docutils literal"><span class="pre">./replicate_A/</span></tt>) and created the following files of interest:</p>
<blockquote>
<div><ul>
<li><p class="first">The <tt class="docutils literal"><span class="pre">countparsedmuts_multi-nt-allcodonmutcounts.txt</span></tt> file gives the fraction of all mutations that involve multiple nucleotide changes to the same codon that are found <span class="math">\(\ge n\)</span> times for <em>n</em> ranging from 0 to 50. The reason that this fraction is of interest is that multiple nucleotide change codon mutations arise only very rarely due to sequencing or reverse-transcription errors &#8211; so occurrence of these mutations will tend to be due to the desired codon mutagenesis process. Here are the first few lines of this file for <em>replicate_A</em> (this is the <tt class="docutils literal"><span class="pre">./replicate_A/countparsedmuts_multi-nt-allcodonmutcounts.txt</span></tt> file):</p>
<blockquote>
<div><pre class="literal-block">
# File listing the fraction of multi-nt-all mutations that are found greater than or equal to n times.
# There are 26892 total multi-nt-all mutations
#n      DNA     RNA     mutDNA  mutvirus-p1     mutvirus-p2     virus-p1        virus-p2
0       1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
1       0.1936  0.2220  0.9981  0.8801  0.8510  0.2259  0.3395
2       0.0750  0.0950  0.9972  0.7986  0.7448  0.0926  0.1451
3       0.0468  0.0627  0.9964  0.7317  0.6689  0.0590  0.0862
4       0.0340  0.0489  0.9955  0.6772  0.6082  0.0451  0.0624
5       0.0272  0.0396  0.9948  0.6302  0.5591  0.0357  0.0483
6       0.0223  0.0333  0.9939  0.5891  0.5173  0.0297  0.0391
7       0.0193  0.0294  0.9927  0.5540  0.4836  0.0255  0.0329
8       0.0161  0.0259  0.9922  0.5244  0.4544  0.0217  0.0287
9       0.0141  0.0231  0.9911  0.4980  0.4299  0.0195  0.0248
10      0.0124  0.0206  0.9901  0.4734  0.4087  0.0173  0.0219

</pre>
</div></blockquote>
<p>These results indicates that multi-nucleotide mutations are essentially never found more than a few times in the <em>DNA</em> and <em>RNA</em> amplicons &#8211; indicating that these mutations only rarely appear due to sequencing or reverse-transcription errors. However, nearly all (99%) multi-nucleotide mutations are found at least 10 times in the <em>mutDNA</em> amplicons, indicating that the codon mutagenesis is nearly comprehensive. Many of the multi-nucleotide mutations are found frequently in the <em>mutvirus-p1</em> amplicons &#8211; but much less completely than for the <em>mutDNA</em> amplicon, as only 47% of mutations are present at least 10 times. This could have two explanations:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The viruses grown from the mutant plasmid library only partially sample that library due to experimental limitations, or...</li>
<li>Many of the multi-nucleotide mutations are deleterious and are purged by selection from the mutant viruses.</li>
</ol>
</div></blockquote>
<p>To attempt to distinguish between these explanations, see the next files...</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">countparsedmuts_multi-nt-syncodonmutcounts.txt</span></tt> file gives the fraction of <strong>synonymous</strong> multi-nucleotide change mutations that are found <span class="math">\(\ge n\)</span> times for <em>n</em> ranging from 0 to 50. We would expect that synonymous mutations will usually not be highly deleterious, and so will usually not be purged by selection during viral growth. (Note however that this is not completely true for influenza, as some synonymous mutations to the virus can be extremely deleterious; see for example <a class="reference external" href="http://jvi.asm.org/content/82/5/2295.short">J Virol, 82, 2295</a> and <a class="reference external" href="http://www.nature.com/nbt/journal/v28/n7/full/nbt.1636.html">Nat Biotech, 28, 723</a>). Here are the first few lines of this file for <em>replicate_A</em> (this is the <tt class="docutils literal"><span class="pre">./replicate_A/countparsedmuts_multi-nt-syncodonmutcounts.txt</span></tt> file):</p>
<blockquote>
<div><pre class="literal-block">
# File listing the fraction of multi-nt-syn mutations that are found greater than or equal to n times.
# There are 289 total multi-nt-syn mutations
#n      DNA     RNA     mutDNA  mutvirus-p1     mutvirus-p2     virus-p1        virus-p2
0       1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
1       0.2180  0.2353  0.9965  0.9446  0.9239  0.2076  0.2872
2       0.0865  0.0900  0.9965  0.9031  0.8962  0.0865  0.1003
3       0.0450  0.0415  0.9931  0.8789  0.8754  0.0588  0.0623
4       0.0173  0.0346  0.9896  0.8581  0.8478  0.0277  0.0415
5       0.0104  0.0173  0.9862  0.8443  0.8131  0.0242  0.0381
6       0.0069  0.0069  0.9827  0.8235  0.7785  0.0242  0.0277
7       0.0035  0.0069  0.9792  0.8062  0.7543  0.0242  0.0173
8       0.0035  0.0035  0.9792  0.7993  0.7474  0.0138  0.0173
9       0.0000  0.0035  0.9758  0.7855  0.7336  0.0138  0.0104
10      0.0000  0.0000  0.9758  0.7682  0.7266  0.0138  0.0069

</pre>
</div></blockquote>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">countparsedmuts_multi-nt-codonmutcounts.pdf</span></tt> file plots the results in the two aforementioned files:</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_countparsedmuts_multi-nt-codonmutcounts.jpg"><img alt="replicate_A/countparsedmuts_multi-nt-codonmutcounts.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_replicate_A_countparsedmuts_multi-nt-codonmutcounts.jpg" style="width: 85%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">replicate_A/countparsedmuts_multi-nt-codonmutcounts.jpg</span></tt> plot.</p>
</div>
</div></blockquote>
<p>We see that the multi-nucleotide synonymous mutations are again sampled very thoroughly in the <em>mutDNA</em> amplicons (98% are found at least 10 times). Now the mutations are also sampled much more thoroughly in the <em>mutvirus-p1</em> amplicons as well, with 77% appearing at least 10 times. This compares to only 47% appearing at least 10 times for all (including nonsynonymous) multi-nucleotide mutations. So the sampling is fairly good here. Why is it not closer to 100% of the <em>mutvirus-p1</em> amplicons? It could be that experimental limitations mean that some of the mutations never make it into the viruses. However, because some synonymous mutations are known to be highly deleterious (see the <a class="reference external" href="http://jvi.asm.org/content/82/5/2295.short">J Virol, 82, 2295</a> and <a class="reference external" href="http://www.nature.com/nbt/journal/v28/n7/full/nbt.1636.html">Nat Biotech, 28, 723</a> references mentioned above), it could simply be a sign that these mutations are under selection. Overall, we interpret the fact that nearly 80% of the synonymous mutations are found at least 10 times in the <em>mutvirus-p1</em> amplicons to be a good sign, and to indicate that most mutations were sampled in the mutant viruses.</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="inference-of-amino-acid-preferences">
<h3><a class="toc-backref" href="#id10">Inference of amino-acid preferences</a><a class="headerlink" href="#inference-of-amino-acid-preferences" title="Permalink to this headline">¶</a></h3>
<p>We next use the results of the deep-sequencing analysis to infer the preference of each site for each amino acid. The MCMC algorithm for inference of the preferences is described in detail in the <a class="reference external" href="http://jbloom.github.io/mapmuts/">mapmuts documentation</a> describing the <tt class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></tt> script.</p>
<p>Briefly, we use the <em>DNA</em> amplicons to estimate the sequencing error rate that afflicts the <em>mutDNA</em> amplicons, and the <em>RNA</em> amplicons to estimate the sequence / reverse-transcription error rate that afflicts the <em>mutvirus-p1</em> amplicons. We then infer the preferences based on changes in frequency going from the <em>mutDNA</em> to the <em>mutvirus-p1</em> (which involves selection for viral growth).</p>
<p>We infer the preferences separately for each <em>replicate</em>, averaging over all of the <em>samples</em> for the replicate. We then compare the inferred preferences among the replicates, and summarize the results graphically.</p>
<p>Specifically, the steps are as follows:</p>
<ol class="arabic">
<li><p class="first">Infer the preferences separately for each <em>sample</em> within each <em>replicate</em> using <tt class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></tt>. The preferences are inferred using both the passage 1 (<em>p1</em>) and passage 2 (<em>p2</em>) mutant viruses, and these inferences are done within the subdirectory for each sample (such as <tt class="docutils literal"><span class="pre">./replicate_A/WT-1/</span></tt>). The input files that specify the parameters used by <tt class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></tt> are in files with names <tt class="docutils literal"><span class="pre">p1_inferpreferences_infile.txt</span></tt> and <tt class="docutils literal"><span class="pre">p2_inferpreferences_infile.txt</span></tt> within each <em>sample</em> subdirectory. The key settings for the priors and MCMC are as follows (the exact meanings are detailed in the <a class="reference external" href="http://jbloom.github.io/mapmuts/">mapmuts documentation</a> for <tt class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre>nsteps 200000
nruns 3
thin 200
convergence 0.01
stepincrease 4
mu_concentration 1.0
pi_concentration 1.0
rho_concentration 1.0
epsilon_concentration 1.0
minvalue 1e-7
removeoutlier False
</pre></div>
</div>
<p>The following files are created within each <em>sample</em> subdirectory. Such files are created both for the <em>p1</em> viruses with names indicated below, and also comparable files for the <em>p2</em> viruses:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">p1_inferpreferences_log.txt</span></tt> logs the MCMC progress.</li>
<li><tt class="docutils literal"><span class="pre">p1_equilibriumpreferences.txt</span></tt> is a text file giving the posterior mean inferred preferences.</li>
<li><tt class="docutils literal"><span class="pre">p1_equilibriumpreferences_credibleintervals_95.txt</span></tt> is a text file giving 95% credible intervals for the inferred preferences.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Compute the overall equilibrium preferences inferred for each <em>replicate</em> by averaging the inferred preferences for the <em>samples</em> in that replicate with <tt class="docutils literal"><span class="pre">mapmuts_preferencemeans.py</span></tt>. This inference is done within every <em>replicate</em> subdirectory (such as <tt class="docutils literal"><span class="pre">./replicate_A/</span></tt> to create the file summarizing the preferences for that replicate. The following files are created:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">./replicate_A/replicate_A_p1_equilibriumpreferences.txt</span></tt> : The preferences inferred for <em>replicate_A</em> using the <em>p1</em> (passaged once) viruses.</li>
<li><tt class="docutils literal"><span class="pre">./replicate_A/replicate_A_p2_equilibriumpreferences.txt</span></tt></li>
<li><tt class="docutils literal"><span class="pre">./replicate_B/replicate_B_p1_equilibriumpreferences.txt</span></tt></li>
<li><tt class="docutils literal"><span class="pre">./replicate_B/replicate_B_p2_equilibriumpreferences.txt</span></tt></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Compute the overall equilibrium preferences across both <em>replicates</em> for the <em>WT</em> samples and the <em>N334H</em> samples with <tt class="docutils literal"><span class="pre">mapmuts_preferencemeans.py</span></tt>. This creates the following files:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">./WT_p1_equilibriumpreferences.txt</span></tt> gives the preferences inferred from the passage 1 (<em>p1</em>) averaged across the <em>WT-1</em> and <em>WT-2</em> <em>samples</em> from both <em>replicates</em>.</li>
<li><tt class="docutils literal"><span class="pre">./N334H_p1_equilibriumpreferences.txt</span></tt></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Compute the overall equilibrium preferences averaged over the two independent replicates (<em>replicate_A</em> and <em>replicate_B</em>) with <tt class="docutils literal"><span class="pre">mapmuts_preferencemeans.py</span></tt>. This is the &#8220;best&#8221; estimate for these preferences as it combines the data for the two replicates. The results are in the main subdirectory for this example in the following files:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">./p1_equilibriumpreferences.txt</span></tt> gives the preferences inferred from the first passage (<em>p1</em>).</li>
<li><tt class="docutils literal"><span class="pre">./p2_equilibriumpreferences.txt</span></tt> gives the preferences inferred from the second passage (<em>p2</em>).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Compute the correlations between the inferred preferences. These allow us to compare the inferred preferences across replicates, and between the passage 1 (<em>p1</em>) and passage 2 (<em>p2</em>) viruses within each replicate. These correlations were computed using the <tt class="docutils literal"><span class="pre">mapmuts_preferencescorrelate.py</span></tt> described in the <a class="reference external" href="http://jbloom.github.io/mapmuts/">mapmuts documentation</a>). The results are in the form of PDF plots that are created in the <tt class="docutils literal"><span class="pre">./correlations/</span></tt> subdirectory. The key plots are shown below. Overall these plots show that the two passages <em>p1</em> and <em>p2</em> are highly correlated with each other. The two independent replicates (<em>replicate_A</em> and <em>replicate_B</em>) are correlated, but less so &#8211; presumably this is due to stochasticity in growth of the viruses from these replicates. The <em>WT</em> and <em>N334H</em> samples are about as correlated as the two replicates.</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_replicate_A_p1_vs_replicate_A_p2.jpg"><img alt="correlations/replicate_A_p1_vs_replicate_A_p2.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_replicate_A_p1_vs_replicate_A_p2.jpg" style="width: 30%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">correlations/replicate_A_p1_vs_replicate_A_p2.jpg</span></tt> plot.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_replicate_B_p1_vs_replicate_B_p2.jpg"><img alt="correlations/replicate_B_p1_vs_replicate_B_p2.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_replicate_B_p1_vs_replicate_B_p2.jpg" style="width: 30%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">correlations/replicate_B_p1_vs_replicate_B_p2.jpg</span></tt> plot.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_replicate_A_p1_vs_replicate_B_p1.jpg"><img alt="correlations/replicate_A_p1_vs_replicate_B_p1.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_replicate_A_p1_vs_replicate_B_p1.jpg" style="width: 30%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">correlations/replicate_A_p1_vs_replicate_B_p1.jpg</span></tt> plot.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_WT_p1_vs_N334H_p1.jpg"><img alt="correlations/WT_p1_vs_N334H_p1.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_correlations_WT_p1_vs_N334H_p1.jpg" style="width: 30%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">correlations/WT_p1_vs_N334H_p1.jpg</span></tt> plot.</p>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="summary-of-amino-acid-preferences">
<h3><a class="toc-backref" href="#id11">Summary of amino-acid preferences</a><a class="headerlink" href="#summary-of-amino-acid-preferences" title="Permalink to this headline">¶</a></h3>
<p>As described in the previous section, the overall best inferences for the amino-acid preferences are contained in the <tt class="docutils literal"><span class="pre">p1_equilibriumpreferences.txt</span></tt> file. To graphically summarize these preferences, the <tt class="docutils literal"><span class="pre">mapmuts_siteprofileplots.py</span></tt> script was used. The resulting logo plot is shown below. For each site, the height of the bars are proportional to the preference for that amino acid at that site. The letters are colored according to amino-acid hydrophobicity, and solvent accessibilities and secondary structures (computed from <a class="reference external" href="http://www.rcsb.org/pdb/explore.do?structureId=2iqh">PDB 2IQH</a> using the <a class="reference external" href="http://www.cmbi.ru.nl/hsspsoap/">DSSP webserver</a>) are overlaid for those residues that are present in the crystal structure.</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Aichi68_p1_site_preferences_logoplot.jpg"><img alt="p1_site_preferences_logoplot.jpg" src="_images/example_2013Analysis_Influenza_NP_Aichi68_p1_site_preferences_logoplot.jpg" style="width: 90%;" /></a>
<p class="caption">The <tt class="docutils literal"><span class="pre">p1_site_preferences_logoplot.jpg</span></tt> plot.</p>
</div>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2013 analysis of Influenza NP (Aichi/1968)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#outline-of-experiment">Outline of experiment</a></li>
<li><a class="reference internal" href="#software-used">Software used</a></li>
<li><a class="reference internal" href="#input-files">Input files</a></li>
<li><a class="reference internal" href="#analysis-steps-and-results">Analysis steps and results</a><ul>
<li><a class="reference internal" href="#making-alignments">Making alignments</a></li>
<li><a class="reference internal" href="#parsing-mutations">Parsing mutations</a></li>
<li><a class="reference internal" href="#checking-mutation-sampling-completeness">Checking mutation sampling completeness</a></li>
<li><a class="reference internal" href="#inference-of-amino-acid-preferences">Inference of amino-acid preferences</a></li>
<li><a class="reference internal" href="#summary-of-amino-acid-preferences">Summary of amino-acid preferences</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter">Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pythonapi.html"
                        title="next chapter">Python modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/example_2013Analysis_Influenza_NP_Aichi68.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pythonapi.html" title="Python modules"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >previous</a> |</li>
        <li><a href="index.html">mapmuts 1.0 documentation</a> &raquo;</li>
          <li><a href="examples.html" >Examples</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3a0.
    </div>
  </body>
</html>